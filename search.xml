<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>rebirth</title>
      <link href="/2022/07/12/setup/"/>
      <url>/2022/07/12/setup/</url>
      
        <content type="html"><![CDATA[<p>It is time for a fresh start.</p><span id="more"></span><p>I switched my operating system to Ubuntu in early 2021, and changed several times after that. In the process of changing the OS, I only backed up my articles, so the configuration files were completely lost. Over the past year, every time I’ve seen these unfinished pages, slight pity have welled up in my mind. Now I’ve decided to redeploy this blog and start a long-term maintenance.</p>        <h1 id="deployment"   >          <a href="#deployment" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#deployment"></a> deployment</h1>      <p>Due to previous deployment experience, this work is going very well.</p><p>Firstly, create a repository and update settings-general-pages option.</p><p>Secondly, initialize hexo in an empty dictionary and modify ‘_config.yml’. Set url to <code>url: https://phlzy.github.io/</code>, and change deploy configuration:</p><figure class="highlight yml"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@github.com:phlzy/phlzy.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></div></figure><p>Then install a hexo theme. Here is the document of <span class="exturl"><a class="exturl__link"   href="https://theme-stun.gitee.io/docs/" >stun</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>.</p>]]></content>
      
      
      <categories>
          
          <category> Tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【OP2】the number of good subsets</title>
      <link href="/2022/03/22/OP2/"/>
      <url>/2022/03/22/OP2/</url>
      
        <content type="html"><![CDATA[<p>状压，dp</p><span id="more"></span><p>题目链接：<span class="exturl"><a class="exturl__link"   href="https://leetcode-cn.com/problems/the-number-of-good-subsets/" >好子集的数目</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p><p>这题有个有趣的条件：数组中的元素的取值范围只有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>30</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,30]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mclose">]</span></span></span></span>。在这个范围内只存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span></span></span></span> 个质数，所以容易想到状压的做法。先统计每个数出现的次数，然后令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> 表示选择 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2,i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> 中的数且用了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 状态中的质因子时的好子集数目，那么状态转移方程也很容易得出：</p><ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 有平方因子，则这个数是没用的，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]=dp[i-1][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></li><li>否则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]=dp[i-1][j]+dp[i-1][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 为状态 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 中去掉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 这个数包含的质因子形成的状态</li></ul><p>初始状态就是选 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 的方案数，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></mrow><annotation encoding="application/x-tex">2^{cnt[1]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span>。</p><p>然后还可以滚动数组优化一下空间，倒序枚举即可。</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> p[<span class="number">10</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>&#125;;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function">ll <span class="title">ksm</span><span class="params">(ll b, ll k)</span> </span>&#123;</span><br><span class="line">ll ret = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (k) &#123;</span><br><span class="line"><span class="keyword">if</span> (k &amp; <span class="number">1</span>) ret = ret * b % mod;</span><br><span class="line">k &gt;&gt;= <span class="number">1</span>, b = b * b % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">numberOfGoodSubsets</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cnt</span><span class="params">(<span class="number">31</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">dp</span><span class="params">(<span class="number">1</span> &lt;&lt; <span class="number">10</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp;&amp; i: nums) cnt[i]++;</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="built_in">ksm</span>(<span class="number">2</span>, cnt[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">30</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!cnt[i]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> now = <span class="number">0</span>, x = i, flag = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">10</span>; ++j) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % (p[j] * p[j]) == <span class="number">0</span>) &#123;</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x % p[j] == <span class="number">0</span>) now |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!flag) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> st = (<span class="number">1</span> &lt;&lt; <span class="number">10</span>) - <span class="number">1</span>; st &gt;= <span class="number">0</span>; --st) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((st &amp; now) == now)</span><br><span class="line">        dp[st] = (dp[st] + dp[st ^ now] * cnt[i]) % mod;</span><br><span class="line">        &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        ll ans = <span class="built_in">accumulate</span>(dp.<span class="built_in">begin</span>() + <span class="number">1</span>, dp.<span class="built_in">end</span>(), <span class="number">0LL</span>) % mod;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>)ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure>]]></content>
      
      
      <categories>
          
          <category> One Problem </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> bitmask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【OP1】Islands War</title>
      <link href="/2022/03/21/OP1/"/>
      <url>/2022/03/21/OP1/</url>
      
        <content type="html"><![CDATA[<p>贪心</p><span id="more"></span><p>题目链接：<span class="exturl"><a class="exturl__link"   href="https://atcoder.jp/contests/abc103/tasks/abc103_d" >Islands War</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 个点形成一条链，给你 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 个点对，让你删掉若干条边使这些点对都不连通，问最少删多少条边。</p><p>可以直观的感受到，如果存在一组两两相交的区间，那么只需要删一条边，即最左边的右端点所在的边。</p><p>于是容易得到一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>log</mi><mo>⁡</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m\log m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 的贪心做法，对所有区间按右端点排序即可。</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> F first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> S second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">pii seg[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)&#123;</span><br><span class="line">cin &gt;&gt; seg[i].F &gt;&gt; seg[i].S;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(seg + <span class="number">1</span>, seg + m + <span class="number">1</span>, [](pii a, pii b)&#123;</span><br><span class="line"><span class="keyword">return</span> a.S &lt; b.S;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="type">int</span> now = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(now &lt;= seg[i].F)&#123;</span><br><span class="line">now = seg[i].S;</span><br><span class="line">ans++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>如果预处理一下每个点需要断的最近右端点，可以把复杂度优化到线性：</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n, m, L = maxn;</span><br><span class="line">cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line"><span class="keyword">if</span>(!m)&#123;</span><br><span class="line">cout &lt;&lt; <span class="number">0</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, l, r; i &lt;= m; ++i)&#123;</span><br><span class="line">cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">L = <span class="built_in">min</span>(L, l);</span><br><span class="line"><span class="keyword">if</span>(a[l] &gt; r || !a[l]) a[l] = r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> now = a[L], ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(!a[i]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(i &gt;= now)&#123;</span><br><span class="line">ans++;</span><br><span class="line">now = a[i];</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(now &gt; a[i])&#123;</span><br><span class="line">now = a[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 个点形成一棵树，将删边改成删点，也可以用类似的方法来做，只需将点对的 LCA 按深度排序后从深的开始删即可。</p>]]></content>
      
      
      <categories>
          
          <category> One Problem </category>
          
      </categories>
      
      
        <tags>
            
            <tag> greedy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AVL tree</title>
      <link href="/2020/02/12/AVL_Tree/"/>
      <url>/2020/02/12/AVL_Tree/</url>
      
        <content type="html"><![CDATA[        <h1 id="简介"   >          <a href="#简介" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#简介"></a> 简介：</h1>      <p>AVL树是最先发明的自平衡二叉查找树。AVL树高度平衡，其任意节点左右子树的高度差不超过1。同时它也拥有普通二叉查找树的性质，即每个节点左子树上所有节点的值均小于根节点的值，右子树上所有节点的值均大于根节点的值，且不同节点的值均不同。</p><span id="more"></span>        <h1 id="实现过程"   >          <a href="#实现过程" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#实现过程"></a> 实现过程</h1>      <p>**平衡因子：**每个节点左子树和右子树的高度差。若所有节点平衡因子的绝对值均不超过1则平衡。</p><p>使用一个结构体保存节点的键值、频数、以该点为根的树的树高和大小以及左右子树。当树不平衡时，可以通过旋转使树平衡。</p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AVL_node</span>;</span><br><span class="line"><span class="keyword">typedef</span> AVL_node *AVL_Tree;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AVL_node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> value, height, freq, size;</span><br><span class="line">    AVL_Tree ls, rs;</span><br><span class="line">    <span class="built_in">AVL_node</span>() : <span class="built_in">value</span>(<span class="number">0</span>), <span class="built_in">height</span>(<span class="number">1</span>), <span class="built_in">freq</span>(<span class="number">1</span>), <span class="built_in">size</span>(<span class="number">1</span>), <span class="built_in">ls</span>(<span class="literal">nullptr</span>), <span class="built_in">rs</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">    <span class="built_in">AVL_node</span>(<span class="type">int</span> n) : <span class="built_in">value</span>(n), <span class="built_in">height</span>(<span class="number">1</span>), <span class="built_in">freq</span>(<span class="number">1</span>), <span class="built_in">size</span>(<span class="number">1</span>), <span class="built_in">ls</span>(<span class="literal">nullptr</span>), <span class="built_in">rs</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p><strong>不平衡情况1（左-左）：</strong></p><p><img src="https://i.loli.net/2020/02/12/BYrixbevTfP8cR4.png" alt="1" /></p><p>在插入1之前，树是平衡的，但是9的左子树比右子树高度大。在9的左子树的左子树插入1（或2，4，5）后，树不平衡了，这种左子树更高且向左子树的左子树插入节点的情况可以通过一次右旋来使树平衡。右旋使原来不平衡的根节点的左子树成为根节点，而原来的根节点成为新的右子树，原来左子树的右子树成为原来的根节点的左子树。容易证明，旋转后依旧具有二叉查找树的性质。</p><p><img src="https://i.loli.net/2020/02/12/mz46SiMWg5lTcfJ.png" alt="2" /></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate_ls_ls</span><span class="params">(AVL_Tree &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVL_Tree q;</span><br><span class="line">    q = p-&gt;ls;</span><br><span class="line">    p-&gt;ls = q-&gt;rs;</span><br><span class="line">    q-&gt;rs = p;</span><br><span class="line">    <span class="built_in">update</span>(p);</span><br><span class="line">    <span class="built_in">update</span>(q);</span><br><span class="line">    p = q;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>不平衡情况2（右-右）：</strong></p><p><img src="https://i.loli.net/2020/02/12/f5eClWkqbJ7XywL.png" alt="3" /></p><p>在插入13之前，树是平衡的，但是8的右子树比左子树高度大。在8的右子树的右子树插入13（或11）后，树不平衡了，这种右子树更高且向右子树的右子树插入节点的情况可以通过一次左旋来使树平衡。左旋使原来不平衡的根节点的右子树成为根节点，而原来的根节点成为新的左子树，原来右子树的左子树成为原来的根节点的右子树。同样，旋转后依旧具有二叉查找树的性质。</p><p><img src="https://i.loli.net/2020/02/12/vhUgRs8SFj41HmV.png" alt="4" /></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate_rs_rs</span><span class="params">(AVL_Tree &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVL_Tree q;</span><br><span class="line">    q = p-&gt;rs;</span><br><span class="line">    p-&gt;rs = q-&gt;ls;</span><br><span class="line">    q-&gt;ls = p;</span><br><span class="line">    <span class="built_in">update</span>(p);</span><br><span class="line">    <span class="built_in">update</span>(q);</span><br><span class="line">    p = q;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>不平衡情况3：（左-右）</strong></p><p><img src="https://i.loli.net/2020/02/12/dRS1WHXAN7MlUhg.png" alt="5" /></p><p>这种情况是在左子树更高的树的左子树的右子树插入节点，需要先进行一次左旋，再进行一次右旋。</p><p>左旋：</p><p><img src="https://i.loli.net/2020/02/12/9S1xL8N2FIvhuZA.png" alt="6" /></p><p>右旋：</p><p><img src="https://i.loli.net/2020/02/12/WgVKU1dbrEno9Ra.png" alt="7" /></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate_ls_rs</span><span class="params">(AVL_Tree &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">rotate_rs_rs</span>(p-&gt;ls);</span><br><span class="line">    <span class="built_in">rotate_ls_ls</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>不平衡情况4：（右-左）</strong></p><p>与情况3相反，先进行一次右旋，再进行一次左旋。</p><p><img src="https://i.loli.net/2020/02/12/6KXb74TNLQUO1RB.png" alt="8" /></p><p>右旋：</p><p><img src="https://i.loli.net/2020/02/12/V5JZvClKTzU8qcP.png" alt="9" /></p><p>左旋：</p><p><img src="https://i.loli.net/2020/02/12/2h8ktCgqNnZR3IW.png" alt="10" /></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate_rs_ls</span><span class="params">(AVL_Tree &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">rotate_ls_ls</span>(p-&gt;rs);</span><br><span class="line">    <span class="built_in">rotate_rs_rs</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>获取树的大小</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">get_size</span><span class="params">(AVL_Tree p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> p-&gt;size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>获取树的高度</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">get_height</span><span class="params">(AVL_Tree p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> p-&gt;height;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>更新</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">update</span><span class="params">(AVL_Tree &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p-&gt;size = <span class="built_in">get_size</span>(p-&gt;ls) + <span class="built_in">get_size</span>(p-&gt;rs) + p-&gt;freq;</span><br><span class="line">    p-&gt;height = <span class="built_in">max</span>(<span class="built_in">get_height</span>(p-&gt;ls), <span class="built_in">get_height</span>(p-&gt;rs)) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>插入</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AVL_insert</span><span class="params">(AVL_Tree &amp;p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p = <span class="keyword">new</span> <span class="built_in">AVL_node</span>(x);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;value == x)<span class="comment">//已经存在,频数+1</span></span><br><span class="line">    &#123;</span><br><span class="line">        (p-&gt;freq)++;</span><br><span class="line">        <span class="built_in">update</span>(p);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;value &gt; x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">AVL_insert</span>(p-&gt;ls, x);</span><br><span class="line">        <span class="built_in">update</span>(p);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;ls) - <span class="built_in">get_height</span>(p-&gt;rs) == <span class="number">2</span>)<span class="comment">//插到左边,左边更高</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (x &lt; p-&gt;ls-&gt;value)</span><br><span class="line">                <span class="built_in">rotate_ls_ls</span>(p);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">rotate_ls_rs</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">AVL_insert</span>(p-&gt;rs, x);</span><br><span class="line">        <span class="built_in">update</span>(p);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;rs) - <span class="built_in">get_height</span>(p-&gt;ls) == <span class="number">2</span>)<span class="comment">//插到右边,右边更高</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (x &gt; p-&gt;rs-&gt;value)</span><br><span class="line">                <span class="built_in">rotate_rs_rs</span>(p);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">rotate_rs_ls</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">update</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>删除数据</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AVL_erase</span><span class="params">(AVL_Tree &amp;p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;value &gt; x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">AVL_erase</span>(p-&gt;ls, x);</span><br><span class="line">        <span class="built_in">update</span>(p);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;rs) - <span class="built_in">get_height</span>(p-&gt;ls) == <span class="number">2</span>)<span class="comment">//删左边，右边高</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;rs-&gt;rs) &gt;= <span class="built_in">get_height</span>(p-&gt;rs-&gt;ls))<span class="comment">//见代码后注释</span></span><br><span class="line">                <span class="built_in">rotate_rs_rs</span>(p);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">rotate_rs_ls</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (p-&gt;value &lt; x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">AVL_erase</span>(p-&gt;rs, x);</span><br><span class="line">        <span class="built_in">update</span>(p);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;ls) - <span class="built_in">get_height</span>(p-&gt;rs) == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;ls-&gt;ls) &gt;= <span class="built_in">get_height</span>(p-&gt;ls-&gt;rs))</span><br><span class="line">                <span class="built_in">rotate_ls_ls</span>(p);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">rotate_ls_rs</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;freq &gt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            (p-&gt;freq)--;</span><br><span class="line">            <span class="built_in">update</span>(p);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;ls &amp;&amp; p-&gt;rs)</span><br><span class="line">        &#123;</span><br><span class="line">            AVL_Tree q;</span><br><span class="line">            q = p-&gt;rs;</span><br><span class="line">            <span class="keyword">while</span> (q-&gt;ls)</span><br><span class="line">                q = q-&gt;ls;</span><br><span class="line">            p-&gt;freq = q-&gt;freq;</span><br><span class="line">            p-&gt;value = q-&gt;value;</span><br><span class="line">            q-&gt;freq = <span class="number">1</span>; <span class="comment">//删除q</span></span><br><span class="line">            <span class="built_in">AVL_erase</span>(p-&gt;rs, q-&gt;value);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;ls) - <span class="built_in">get_height</span>(p-&gt;rs) == <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">get_height</span>(p-&gt;ls-&gt;ls) &gt;= <span class="built_in">get_height</span>(p-&gt;ls-&gt;rs))</span><br><span class="line">                    <span class="built_in">rotate_ls_ls</span>(p);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">rotate_ls_rs</span>(p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            AVL_Tree q;</span><br><span class="line">            q = p;</span><br><span class="line">            <span class="keyword">if</span> (p-&gt;ls)</span><br><span class="line">                p = p-&gt;ls;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (p-&gt;rs)</span><br><span class="line">                p = p-&gt;rs;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                p = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="keyword">delete</span> q;</span><br><span class="line">            q = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">update</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>第11行必须用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo></mrow><annotation encoding="application/x-tex">\ge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">≥</span></span></span></span>，否则遇到如图的情况：</p><p><img src="https://i.loli.net/2020/02/12/XuxmhoWtJvaCqwp.png" alt="11" /></p><p>删去13后，先右旋再左旋，树仍然不是平衡的：</p><p><img src="https://i.loli.net/2020/02/12/U4IajS9vukohHml.png" alt="12" /></p><p><strong>通过值查找位次</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_rank</span><span class="params">(AVL_Tree p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;value == x)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get_size</span>(p-&gt;ls) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;value &gt; x)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get_rank</span>(p-&gt;ls, x);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get_rank</span>(p-&gt;rs, x) + <span class="built_in">get_size</span>(p-&gt;ls) + p-&gt;freq;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>通过位次查找值</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_val</span><span class="params">(AVL_Tree p, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">get_size</span>(p-&gt;ls) &gt;= r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get_val</span>(p-&gt;ls, r);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">get_size</span>(p-&gt;ls) + p-&gt;freq &gt;= r)</span><br><span class="line">        <span class="keyword">return</span> p-&gt;value;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get_val</span>(p-&gt;rs, r - <span class="built_in">get_size</span>(p-&gt;ls) - p-&gt;freq);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>查找前驱</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_pre</span><span class="params">(AVL_Tree p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVL_Tree ans = <span class="keyword">new</span> <span class="built_in">AVL_node</span>(-inf);</span><br><span class="line">    <span class="keyword">while</span> (p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;value == x)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p-&gt;ls)</span><br><span class="line">            &#123;</span><br><span class="line">                p = p-&gt;ls;</span><br><span class="line">                <span class="keyword">while</span> (p-&gt;rs)</span><br><span class="line">                &#123;</span><br><span class="line">                    p = p-&gt;rs;</span><br><span class="line">                &#125;</span><br><span class="line">                ans = p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;value &lt; x &amp;&amp; p-&gt;value &gt; ans-&gt;value)</span><br><span class="line">            ans = p;</span><br><span class="line">        p = p-&gt;value &lt; x ? p-&gt;rs : p-&gt;ls;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans-&gt;value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>查找后继</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_suf</span><span class="params">(AVL_Tree p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVL_Tree ans = <span class="keyword">new</span> <span class="built_in">AVL_node</span>(inf);</span><br><span class="line">    <span class="keyword">while</span> (p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;value == x)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p-&gt;rs)</span><br><span class="line">            &#123;</span><br><span class="line">                p = p-&gt;rs;</span><br><span class="line">                <span class="keyword">while</span> (p-&gt;ls)</span><br><span class="line">                &#123;</span><br><span class="line">                    p = p-&gt;ls;</span><br><span class="line">                &#125;</span><br><span class="line">                ans = p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;value &gt; x &amp;&amp; p-&gt;value &lt; ans-&gt;value)</span><br><span class="line">            ans = p;</span><br><span class="line">        p = p-&gt;value &lt; x ? p-&gt;rs : p-&gt;ls;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans-&gt;value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>中序遍历</strong></p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">output</span><span class="params">(AVL_Tree p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">output</span>(p-&gt;ls);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= p-&gt;freq;i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, p-&gt;value);</span><br><span class="line">    <span class="built_in">output</span>(p-&gt;rs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>AVL树的插入、删除、查找都是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span></span></span></span>级别的复杂度，其中AVL树的查询和其它平衡树相比会更有优势，但是AVL树代码量比较大，总体速度也很一般，可以分裂合并，可持久化，但是比较难写。</p><p>终于写完了，真是不容易。</p><p><img src="https://i.loli.net/2020/02/12/1scLYZaiKRt25N3.jpg" alt="v2-28825ec8201c53892205bfd8b41c97dd_hd.jpg" /></p>]]></content>
      
      
      <categories>
          
          <category> Algorithm and DataStructure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> data structure </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
